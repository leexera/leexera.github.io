---
layout: post
title: "Classical Object Detection - HOG"
description: "Part 2. 컴퓨터비전 특화 이론과 실습", "Ch05. 객체탐지(Object Detection)와 분할(Segmentation)"
date: 2023-03-15
tags: study
comments: true
---

classical objective detection의 feature extraction방법인 histogram of Oriented Gradient (HOG) 방식에 대하여 배워본다.

---
# Histogram of Oriented Gradients (HOG)

 * Gradient image computation
    - No Gaussian smoothing
    - Filters to compute horizontal-vertical gradient images:
    <i>f<sub>x<sub></i> = [-1 0 +1]
    <i>f<sub>y</sub></i> = [-1 0 +1]<sup>T</sup>
    ![image](https://user-images.githubusercontent.com/122149118/225199185-35415aa1-84fa-40a2-b2bf-8414018f7b22.png)
 * Use color infotmation when available
    - Compute gradient in each channel and choose the maximum gradient

 HOG는 image gradient 정보를 사용한다.
 image gradient의 orientation, 방향성을 구하는 것이다.
 방향성을 구하는 방법은 histogram형태로 구하게된다.
 먼저 image의 gradient를 구한 후 이 때 Gaussian smoothing을 하지않는데 그 이유는 Gaussian smoothing을 하게되면 방향성의 정보가 많이 사라지게 되므로 smoothing을 기본적으로 하지 않는다.
 Gaussian smoothing을 하면 noise 부분들이 없어질 수는 있겠지만 좀 더 선명한 정보를 얻기 위해 하지 않는 것이다.
 horizontal과 vertical gradient image를 얻는다.
 f<sub>x</sub> * I로 image gradient 표현을 해준다.
 x 방향의 gradient와 y 방향의 gradient, 조도가 얼마나 변하는지에 대한 정보로 y 방향은 y 방향으로 넘어갈 때 잡히게 되고 x 방향은 x 방향으로 넘어갈 때 잡히게 된다.
 kernel모양은 아주 간단하다.
 [-1 0 +1]을 통과시켜 x를 판단하게 되고 [-1 0 +1]을 transpose한 kernel을 통과시키면 y 방향의 gradient를 얻을 수 있게된다.
 color information이 available한 경우에는 color information을 사용한다.
 gray scale로 만들어 histogram gradient를 뽑기도 하지만 color RGB space 정보가 있다면 각 channel에 대해서 gradient를 구하고 모두 다 사용하는 것이 아니라 maximum한 gradient를 선택, 즉 maxpooling하여 사용하는 것이다.
 그러면 h X w X 1 channel의 HOG값이 나올 것이다.
 
 * Weighted vote into quantized orientations
 ![image](https://user-images.githubusercontent.com/122149118/225200770-1f00c2e9-6653-4a99-9238-bef9a5635b3e.png)
 * Each pixel cats a weighted vote by gradient magnitude for an oriented histogram
 ![image](https://user-images.githubusercontent.com/122149118/225200870-91f1ef5c-afcb-4608-a60e-4343ca93549b.png)

 HOG값이 아닌 x와 y방향의 gradient인데, 그것의
##### Center
{: .center}

##### Right
{: .right}

## 2. Body Text

Lorem ipsum dolor sit amet, [test link](https://www.google.com) adipiscing elit. **This is strong.** Nullam dignissim convallis est. Quisque aliquam. *This is emphasized.* Donec faucibus. Nunc iaculis suscipit dui. 5<sup>3</sup> = 125. Water is H<sub>2</sub>O. Nam sit amet sem. Aliquam libero nisi, imperdiet at, tincidunt nec, gravida vehicula, nisl. <u>Underline</u>. Maecenas ornare tortor. Donec sed tellus eget `COPY filename` sapien fringilla nonummy. Mauris a ante. Suspendisse quam sem, consequat at, <del>Dinner’s at 5:00.</del> commodo vitae, feugiat in, nunc. Morbi imperdiet augue <mark>mark element</mark> quis tellus.

## 3. Images

![Large example image](http://placehold.it/800x400 "Large example image")

![Medium example image](http://placehold.it/400x200 "Medium example image")
![Small example image](http://placehold.it/200x200 "Small example image")

### 3-1. Image Alignment

![Center example image](http://placehold.it/200x200 "Center")
{: .center}

## 4. Blockquotes

> Lorem ipsum dolor sit amet, test link adipiscing elit. Nullam dignissim convallis est. Quisque aliquam.

## 5. List Types

### Unordered List

* Lorem ipsum dolor sit amet, consectetur adipiscing elit.
* Nam ultrices nunc in nisi pellentesque ultricies. Cras scelerisque ipsum in ante laoreet viverra. Pellentesque eget quam et augue molestie tincidunt ac ut ex. Sed quis velit vulputate, rutrum nisl sit amet, molestie neque. Vivamus sed augue at turpis suscipit fringilla.
* Integer pretium nisl vitae justo aliquam, at varius nisi blandit.
  1. Nunc vehicula nulla ac odio gravida vestibulum sed nec mauris.
  2. Duis at diam eget arcu dapibus consequat.
* Etiam vel elit in purus iaculis pretium.

### Ordered List

1. Quisque ullamcorper leo non ex pretium, in fermentum libero imperdiet.
2. Donec eu nulla euismod, rhoncus ipsum nec, faucibus elit.
3. Nam blandit purus gravida, accumsan sem in, lacinia orci.
  * Duis congue dui nec nisi posuere, at luctus velit semper.
  * Suspendisse in lorem id lacus elementum pretium nec vel nibh.
4. Aliquam eget ipsum laoreet, maximus risus vitae, iaculis leo.

### Definition Lists

kramdown
: A Markdown-superset converter

Maruku
: Another Markdown-superset converter

## 6. Tables

| Header1 | Header2 | Header3 |
|:--------|:-------:|--------:|
| cell1   | cell2   | cell3   |
| cell4   | cell5   | cell6   |
|----
| cell1   | cell2   | cell3   |
| cell4   | cell5   | cell6   |
|=====
| Foot1   | Foot2   | Foot3


## 7. Code Snippets

### Highlighted Code Blocks

```css
#container {
  float: left;
  margin: 0 -240px 0 0;
  width: 100%;
}
```

### Standard code block

    <div id="awesome">
      <p>This is great isn't it?</p>
    </div>
