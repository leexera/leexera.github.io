---
layout: post
title: "ê°ì²´ íƒì§€(Object detection)ê³¼ ë¶„í• (segmentation) Overview"
description: "Part 2. ì»´í“¨í„°ë¹„ì „ íŠ¹í™” ì´ë¡ ê³¼ ì‹¤ìŠµ"
date: 2023-02-28
tags: study
comments: true
---

* ğŸ“Œ Classical Object Detection
   ###### Classical Object Detectionì´ ì–´ë–»ê²Œ ì§„í–‰ë˜ëŠ”ê°€, feautre extractionìœ¼ë¡œë¶€í„° ì–´ë–»ê²Œ decision boundaryë¥¼ ê·¸ë ¤ì„œ object bounding boxë¥¼ ì°¾ì•˜ì—ˆëŠ”ì§€ ì•Œì•„ë³¸ë‹¤.
* ğŸ“Œ Region Proposal : R-CNN
   ###### Deep learning ê¸°ë°˜ì˜ ë°©ë²•ìœ¼ë¡œì„œ Region Proposalë¥¼ ì‚¬ìš©í•˜ëŠ” Two stage detectorì¸ R-CNN Region CNN ê³„ì—´ì˜ networkë¥¼ ë°°ì›Œë³¸ë‹¤.
* ğŸ“Œ One stage Detector : YOLO
   ###### One stage detectorì¸ YOLOì™€ ê°™ì€ networkë¥¼ ë°°ì›Œë³¸ë‹¤.
* ğŸ“Œ Feature Pyramid Network
   ###### ì¡°ê¸ˆ ë” detectionì„ ì˜í•˜ê¸° ìœ„í•´ì„œ ì‚¬ìš©í•˜ëŠ” techniqueì¸ Feature Pyramid Networkì™€ ê°™ì€ imageì˜ multi scale ì •ë³´ë¥¼ integrationí•˜ëŠ” Networkë¥¼ ë°°ì›Œë³¸ë‹¤.
* ğŸ“Œ EfficientDet
   ###### Efficient Detectorë¼ê³  í•˜ëŠ” Efficient Netê³¼ ë¹„ìŠ·í•˜ê²Œ Networkì˜ scaleë“±ì„ í‚¤ìš°ë©´ì„œ ì¡°ê¸ˆ ë” íš¨ê³¼ì ì¸ networkë¥¼ ì–»ê³  detectorë¥¼ ë§Œë“œëŠ” ê²ƒì— ëŒ€í•˜ì—¬ ë°°ì›Œë³¸ë‹¤.
* ğŸ“Œ DETR(Detection Trnasformer)
   ###### DETR(Detection Transformer), ìµœê·¼ì— ìœ í–‰í•˜ëŠ” Vision Transformer êµ¬ì¡°ë¥¼ ì‚¬ìš©í•œ detection transformerë¼ëŠ” DETRêµ¬ì¡°ë¥¼ ë°°ì›Œë³¸ë‹¤.
* ğŸ“Œ 3D Objectdetection
   ###### 2D Object ë¿ë§Œ ì•„ë‹ˆë¼ 3D Objectë¥¼ 2ì°¨ì› í‰ë©´ìƒì—ì„œ ì–´ë–»ê²Œ ì°¾ì„ ê²ƒì¸ì§€ì— ëŒ€í•´ ë°°ì›Œë³¸ë‹¤. 2D imageìƒì—ì„œ 3Dì˜ scaleì„ ì–´ë–»ê²Œ ì°¾ì„ì§€ 3D objectë¥¼ ì°¾ì„ì§€ì— ëŒ€í•´ì„œ ë‹¤ë£¬ë‹¤. <del>3D data êµ¬ì¡°ì— ëŒ€í•œ ê²ƒì€ ë‹¤ë£¨ì§€ ì•ŠëŠ”ë‹¤.</del>

* Semantic Segmentation : SuperPixel
   ###### imageì˜ pixel levelì˜ ì–´ë–¤ classification label, ë˜ ìœ„ì¹˜ë„ ì°¾ì•„ì£¼ëŠ” Semantic Segmentationì— ëŒ€í•´ì„œ ë°°ì›Œë³¸ë‹¤. ê³ ì „ì ì¸ ë°©ë²•ì¸ SuperPixel ë°©ë²•ì„ ë¨¼ì € ì´ì•¼ê¸° í•œë‹¤.
* Fully-Convolution Networks(FCN)
   ###### Fully-Convolution Network(FCN) ì´ë¼ëŠ” ì²« ë²ˆì§¸ë¡œ ë‚˜ì™”ë˜ semantic segmentation ë¬¸ì œë¥¼ í‘¸ëŠ” Networkì— ëŒ€í•´ ë°°ì›Œë³¸ë‹¤.
* DeconvNet, U-Net
   ###### ì¢€ ë” imageì˜ predictionì„ ë†’ì´ê¸° ìœ„í•´ ì‚¬ìš©í–ˆë˜ DeconvNetì´ë‚˜ U-Netê³¼ ê°™ì€ ì–´ë–¤ Upsampling convolutionì„ ì‚¬ìš©í•˜ì—¬ Networkë¥¼ êµ¬ì„±í•˜ëŠ” modelë“¤ì— ëŒ€í•´ ë°°ì›Œë³¸ë‹¤.
* DeepLab
   ###### Semantic Segmentationì—ì„œ í•œ íšì„ ê·¸ì—ˆë˜ DeepLab series, DeepLabê³¼ CRFê´€ë ¨í•˜ì—¬ post processingí•œ ê¸°ë²•ë“¤ì— ëŒ€í•´ ë°°ì›Œë³¸ë‹¤.
* Mask R-CNN
   ###### instance segmentation ë¬¸ì œë¥¼ í‘¼ ê²ƒìœ¼ë¡œ instance segmentationì€ semantic segmentationê³¼ object detectionì„ í•©ì³ì„œ objectê°€ ì–´ë””ì— ìˆëŠ”ì§€ë„ íŒŒì•…ì„ í•˜ê³  ì–´ë–¤ segmentation labelì— ê°–ëŠ”ì§€ ë™ì‹œì— íŒë‹¨í•˜ëŠ”, mask R-CNNì— ëŒ€í•´ ë°°ì›Œë³¸ë‹¤.
* Segmenter
   ###### Segmenterë¼ê³  ë¶€ë¥´ëŠ” vision transformer êµ¬ì¡°ë¥¼ ì‚¬ìš©í•˜ì—¬ featureë¥¼ extractioní•˜ê³  segmentation maskë¥¼ ì°¾ì•„ë‚´ëŠ” segmentation êµ¬ì¡°ì— ëŒ€í•´ì„œ ë°°ì›Œë³¸ë‹¤.
* Weakly-Supervised Learning
   ###### ê°•í•œ ì§€ë„í•™ìŠµì´ ì•„ë‹Œ classification labelë§Œ ê°€ì§€ê³ ë„ object detection, ë” ì–´ë ¤ìš´ object detectionì´ë‚˜ semantic segmentationê°™ì€ ë¬¸ì œë¥¼ í‘¸ëŠ” Weakly-Supervised object detection, Weakly-Supervised Learningê¸°ë²•ì— ëŒ€í•´ ë°°ì›Œë³¸ë‹¤.
* Grad-CAM
   ###### ëŒ€í‘œì ì¸ ë°©ë²•ì¸ Grad-CAM, Gradient Class Activation Map, Class Activation Mapì„ ìˆ˜ë„ lableë¡œ ì‚¬ìš©í•˜ì—¬ semantic segmentationì´ë‚˜ object detectionì„ í‘¸ëŠ” ê¸°ë²•ì— ëŒ€í•´ ë°°ì›Œë³¸ë‹¤.
* Human
   ###### Human Pose Estimationì´ë‚˜ Human Pose Recognitionê³¼ ê°™ì€ Humanê³¼ ê´€ë ¨ëœ 2ì°¨ì› ì •ë³´ì—ì„œ ì •ë³´ë¥¼ ì¶”ì¶œí•´ë‚´ëŠ” Human ê´€ë ¨ taskë¥¼ ë°°ì›Œë³¸ë‹¤.

---

# Popular Visual Recognition Tasgks

 ![image](https://user-images.githubusercontent.com/122149118/221815712-f6848f1e-652e-4a38-aa52-3206c2a3feba.png)

 ì™¼ìª½ì€ Image classification Taskë¥¼ í‘¼ë‹¤ê³  í•œë‹¤ë©´ Imageì˜ ì–´ë–¤ class labelì´ ìˆëŠ”ì§€ ì°¾ëŠ” ê²ƒì´ë‹¤.
 Personì´ ìˆê³  Bikeê°€ ìˆë‹¤ëŠ” ê²ƒì„ ì•Œ ìˆ˜ ìˆë‹¤.
 ì´ê²ƒì„ ìˆœí™”í•˜ì—¬ Object detectionì´ë¼ê³  í•˜ë©´ ì‚¬ëŒì´ ìˆëŠ” ê³³ì— ì‚¬ê°í˜•ì˜ bounding boxë¥¼ ì°¾ì•„ì£¼ê³  ì˜¤í† ë°”ì´ê°€ ìˆëŠ” ê³³ì— ì‚¬ê°í˜•ì˜ bounding boxë¥¼ ì°¾ì•„ì£¼ëŠ” ê²ƒì´ object detectionì´ë‹¤.
 semantic segmentationì€ pixel ìˆ˜ì¤€ì—ì„œ pixel ìˆ˜ì¤€ì˜ classification labelì„ ì°¾ì•„ì£¼ëŠ” taskì´ë‹¤.
 ì‚¬ëŒì˜ ê° ìš”ì†Œë“¤ì— ëŒ€í•´ ë¹¨ê°„ìƒ‰ìœ¼ë¡œ Humanì´ë¼ê³  annotateê°€ ë˜ê³ , ì˜¤í† ë°”ì´ì— ëŒ€í•´ì„œëŠ” ì´ˆë¡ìƒ‰ìœ¼ë¡œ bikeë¼ëŠ” annotateê°€ ë˜ëŠ” ì •ë³´ë¥¼ ì°¾ëŠ” ê²ƒì´ë‹¤.
 ë…¸ë€ìƒ‰ ì˜ì—­ì— ëŒ€í•´ì„œëŠ” don't care ì˜ì—­ì´ê¸° ë•Œë¬¸ì— ì‚¬ëŒì´ ê²°êµ­ í‰ê°€í•´ì•¼í•˜ëŠ”ë°, ì‚¬ëŒì´ë¼ê³  í•˜ê¸°ì—ë„ ì˜¤í† ë°”ì´ë¼ê³  í•˜ê¸°ì—ë„ ëª¨í˜¸í•œ back groundë¼ê³  í•˜ê¸°ì—ë„ ëª¨í˜¸í•˜ì—¬ don't care, êµ³ì´ êµ¬ë¶„í•´ë„ ë˜ì§€ ì•Šì•„ë„ ë˜ëŠ” ì˜ì—­ì„ ë…¸ë€ìƒ‰ìœ¼ë¡œ ë‚˜íƒ€ë‚´ì—ˆë‹¤.
 ë”°ë¼ì„œ visual recognition taskë¥¼ í¬ê²Œ 3ê°€ì§€ë¡œ ë‚˜ëˆŒ ìˆ˜ ìˆë‹¤.

 ![image](https://user-images.githubusercontent.com/122149118/221822379-805008c0-068f-452f-8c8f-42dcb5429185.png)

 ì¡°ê¸ˆ ë” detailí•˜ê²Œ ì‚´í´ ë³´ë©´ classification ë¬¸ì œê°€ ìˆê³ , classificationì˜ single objectì— ëŒ€í•´ì„œ ë˜ëŠ” ì—¬ëŸ¬ ì¥ì˜ objectê°€ ìˆì„ ìˆ˜ ìˆì§€ë§Œ ê¸°ë³¸ì ìœ¼ë¡œ single objectì— ëŒ€í•´ì„œ ì°¾ëŠ” taskì´ë‹¤.
 ê·¸ë¦¬ê³  semantic segmentationì€ classì— pixel level label imageì—ì„œ pixel level labelì„ ì°¾ì•„ì£¼ëŠ”ë° ì˜ˆë¥¼ ë“¤ì–´ GRASSë‚˜, CAT, TREE, SKYë¥¼ segmentë¥¼ ë‚˜ëˆ„ì–´ ì£¼ê²Œ ëœë‹¤.
 ì–´ë–¤ object ìœ„ì£¼ë¥¼ ì°¾ì•„ì£¼ëŠ” ê²ƒì€ ì•„ë‹ˆê³  pixelë§Œ, ì–´ë–¤ pixelì´ ë¬´ìŠ¨ classì •ë„ ì¸ì§€ì •ë„ë§Œ class labelì„ ì°¾ì•„ì£¼ëŠ” ê²ƒì´ë‹¤.
 ë°˜ë©´ì— object localizationì´ë¼ëŠ” taskëŠ” classificationê³¼ localizationì„ ë”í•˜ì—¬ objectê°€ ì–´ë””ìˆëŠ”ì§€ localizeë¥¼ í•´ì£¼ê³  ê·¸ê²Œ ì–´ë–¤ classì¸ì§€ 'CAT'ì´ë¼ê³  ì°¾ì•„ì£¼ëŠ” ê²ƒì´ë‹¤.
 ë³´í†µ object localizationì€ í•˜ë‚˜ì˜ single objectì—ëŒ€í•´ì„œë§Œ ëŒ€ì²´ë¡œ í•œë‹¤.
 Object Detectionì€ Object localizationê³¼ ë‹¬ë¦¬ ì—¬ëŸ¬ ê°œì˜ objectê°€ ìˆì„ ìˆ˜ ìˆê³  ê·¸ objectë“¤ì˜ ê°ê°ì˜ labelì„ ì°¾ì•„ì£¼ëŠ” 'DOG'ê°€ ìˆìœ¼ë©´ 'DOG' bounding boxê°€ ìˆê³  Dogì— ëŒ€í•´ì„œ classë¥¼ ì°¾ì•„ì£¼ê³ , 'CAT'ì— ëŒ€í•´ì„œ bounding boxë¥¼ ì°¾ì•„ì£¼ê³  class labelì„ ì°¾ì•„ì£¼ëŠ” ê²ƒì´ë‹¤.
 Instance Segmentationì€ Semantic Segmentationê³¼ Object Detectionì„ í•©ì¹œ ê²ƒê³¼ ê°™ë‹¤.
 Semantic Segmentationì€ objectì˜ ìœ„ì¹˜ë¥¼ ì°¾ì•„ì£¼ê³  ê±°ê¸°ì— ëŒ€í•´ì„œ Sementic label, Sementic segmentation labelì„ ì°¾ì•„ì£¼ëŠ” taskì´ë‹¤.

# Deep Learning for Object Dtection : A Naive Approch

 ![image](https://user-images.githubusercontent.com/122149118/221826138-b936a933-8ad0-49f7-b53b-43ba9559fdd6.png)
 ###### (<i>left</i>) Selective Search for Object Detection, UCV 2013
 ###### (<i>right</i>) Edge Boxes : Locating
 Motivated by the great success of deep learning in image classification
 Object Detection = Box localization(â¡ Object proposals) + Box classification(â¡ CNN)

 Object Detectionì„ ìœ„í•œ ê°€ì¥ naiveí•œ approachëŠ” image classificationê³¼ ë¹„ìŠ·í•œ ë°©ì‹ì„ ì‚¬ìš©í•˜ëŠ” ê²ƒì´ë‹¤.
 ë¨¼ì € Boxë¥¼ localizationí•˜ê³ , Boxì— ëŒ€í•´ì„œ Classificationì„ í•´ì„œ Boxê°€ ë¬´ì—‡ì¸ì§€ ì•Œê²Œëœë‹¤.
 ë³´í†µ Box localizationì€ Object proposalsë¥¼ ë½‘ëŠ”ë‹¤.
 ê·¸ë¦¬ê³  Box classificationì€ CNN êµ¬ì¡°ë¥¼ ì‚¬ìš©í•˜ì—¬ ë½‘ê±°ë‚˜ ê¸°ì¡´ì˜ ê³ ì „ì ì¸ classification modelì¸ softfactor machineì´ë‚˜ ê·¸ëŸ¬í•œ ê¸°ë²•ë“¤ì„ ì‚¬ìš©í•œë‹¤.
 ê¸°ë³¸ì ì¸ Object Detectionì˜ ì˜ˆì‹œëŠ” ì™¼ìª½ì— ë‚˜íƒ€ë‚˜ìˆëŠ” Selective Searchë¼ëŠ” ê²ƒì„ ì‚¬ìš©í•˜ì—¬ Object Detectionì„ í•˜ê²Œ ëœë‹¤.
 Selective Searchë¥¼ í†µí•´ì„œ Bounding Boxë¥¼ ì°¾ëŠ”ë‹¤.
 ê·¸ Bounding boxë“¤ì— ëŒ€í•´ì„œ classificationì„ í•˜ì—¬ ì•„ë¬´ê²ƒë„ ì•„ë‹Œ confidenceê°€ ë„ˆë¬´ ë‚®ì€ íŒŒë€ìƒ‰ê³¼ ê°™ì€ boxë“¤ì€ ì•„ë¬´ê²ƒë„ ì•„ë‹ˆë¼ê³  í•´ì£¼ê³  ì –ì†Œë¥¼ ê°€ì¥ ì˜ ì¡ì€ boxì— ëŒ€í•´ì„œëŠ” ì´ˆë¡ìƒ‰ìœ¼ë¡œ ë‚˜íƒ€ë‚´ì¤€ë‹¤.
 ì˜ì—­ë“¤ì— ëŒ€í•´ì„œ corseí•˜ê²Œ ë¨¼ì € ì°¾ì•„ì£¼ê³  ì˜ì—­ì„ ë‚˜ëˆ„ì–´ fineí•˜ê²Œ ì°¾ì•„ ì°¾ì•„ì§„ object ì˜ì—­ë“¤ì„ í•˜ë‚˜ì˜ ì–´ë–¤ boxë“¤ë¡œ ë‹¤ì‹œ mergeë¥¼ í•´ì£¼ëŠ” ë°©ì‹ìœ¼ë¡œ ì°¾ì•„ì¤€ë‹¤.
 ì˜¤ë¥¸ìª½ì— ë‚˜íƒ€ë‚˜ìˆëŠ” ê·¸ë¦¼ì€ Edge Boxë¼ëŠ” algorithmìœ¼ë¡œ Edge proposalë“¤ì„ í™œìš©í•˜ì—¬ ì°¾ì•„ì£¼ëŠ” Object proposalì„ ì°¾ëŠ” algorithmì´ë‹¤.

# Region-based CNN* (RCNN)

 ![image](https://user-images.githubusercontent.com/122149118/222064503-3ee5fbc8-a0ac-4b51-9d31-7feef11bef80.png)

 Object proposalì„ ì°¾ëŠ” ë°©ì‹ì„ ê¸°ë°˜ìœ¼ë¡œ region proposalìì²´ë¥¼ í•™ìŠµí•˜ê±°ë‚˜ region proposalë¡œë¶€í„° CNNì„ í™œìš©í•˜ê³ ì í•˜ëŠ” RCNN, region based CNN ê³„ì—´ì˜ ë…¼ë¬¸ë“¤ì´ ë§ì´ ë‚˜ì˜¤ê¸° ì‹œì‘í•œë‹¤.
 Input imageê°€ ë“¤ì–´ê°€ë©´ selective search, edge boxë“±, ë‹¤ë¥¸ networkë“¤ì„ ì´ìš©í•˜ì—¬ region proposalì„ ë½‘ê³ , ê·¸ ë‹¤ìŒ CNN featureë“¤ì„ ë½‘ê³  architectureë¥¼ í†µí•´ì„œ ì–´ë–¤ boxì— ëŒ€í•´ì„œ classì— ëŒ€í•œ labelì´ Yesì¸ì§€ ë˜ëŠ” Noì¸ì§€ classificationí•˜ëŠ” ê²ƒì´ë‹¤.
 ì´ ë•ŒëŠ” softmaxë‚˜ SVMì„ ì´ìš©í•˜ì—¬ ì–´ë–¤ logic ê°’ì„ í†µí•˜ì—¬ classificationì„ í•˜ê²Œëœë‹¤.

 **Summary**
 * Independent evaluation of each proposal Any architecture
 * Bounding box regression imporves detection accuracy
 * Mean average precision (mAP): 53.7% with bounding box regression in VOC 2010 test set

 ì–´ë–¤ proposal networkë¥¼ ë‹¤ ì‚¬ìš©í•˜ì—¬ë„ ë…ë¦½ì ì¸ í‰ê°€ê°€ ê°€ëŠ¥í•˜ë‹¤.
 Bounding Box regressionì„ í†µí•´ì„œ Bounding Box ìì²´ë„ í•™ìŠµì„ í•˜ëŠ” ì œì•ˆì„ í–ˆë‹¤.
 Object detectioì˜ evaluation metricì¸ Mean average precision (mAP)ì˜ ì„±ëŠ¥ë„ í–¥ìƒì‹œì¼°ë‹¤.

 * Learning a transformation of bounding box

 ![image](https://user-images.githubusercontent.com/122149118/222064681-e28934cf-747b-4199-a93a-8c923ccc3a2e.png)

 RCNNì˜ ê¸°ë³¸ì ì¸ ì´ë…ì€ bounding boxì˜ transformationì„ ë°°ìš°ëŠ” ê²ƒì´ë‹¤.
 ì–´ë–¤ region proposalì˜ í›„ë³´ê°€ ë‚˜ì™”ì„ ë•Œ ê·¸ ê·¼ì²˜ë¡œ ì–´ë–»ê²Œ Ground Truthë¡œ ê°€ëŠ” ì°¨ì´ë¥¼ transformationì„ í•™ìŠµì„ í•˜ì—¬ boxë¥¼ ì˜®ê²¨ì£¼ëŠ” í˜•íƒœë¡œ í•™ìŠµì„ í•˜ëŠ” loss functionì„ ì‚¬ìš©í•œë‹¤.
 ìµœì¢…ì ìœ¼ë¡œ box, predictionê³¼ Ground Truthë¥¼ ê°€ê¹ê²Œ ë§Œë“œëŠ” í˜•íƒœë¡œ lossë¥¼ ì œì•ˆí–ˆë‹¤.

# Faster R-CNN with ResNet

 ![image](https://user-images.githubusercontent.com/122149118/222064744-7642acd2-cc58-47a7-a60c-52609c70919e.png)

 Resion based CNNì„ ì¡°ê¸ˆ ë” ì¢‹ê²Œ ë§Œë“œëŠ” Faster RCNNì´ ìˆë‹¤.
 ìµœê·¼ê²©ì´ë¼ê³  ë§í•  ìˆ˜ ìˆëŠ” two stage detectorì˜ Faster RCNNì˜ ê²°ê³¼ëŠ” objectë“¤ì„ ì˜ ì¡ì•„ì£¼ëŠ” ê²ƒì„ ìœ„ì˜ ì‚¬ì§„ì„ í†µí•´ ì •ì„±ì ì¸ ê²°ê³¼ë¥¼ í™•ì¸í•  ìˆ˜ ìˆë‹¤. 
 
 ![image](https://user-images.githubusercontent.com/122149118/222064835-145036cb-3d6f-4fee-b91a-8e1fbf5c7ab2.png)

 ì–´ë–¤ randomí•œ drama ì¥ë©´ì— ëŒ€í•´ì„œë„ detectionì„ ë†’ì€ confidence scoreë¡œ ì°¾ì•„ë‚´ëŠ” ê²ƒì„ í™•ì¸í•  ìˆ˜ ìˆë‹¤.

# Fully-Convolutional Networks (FCN) for Semantic Segmentation
 
 * The first end-to-end architecture for semantic segmentation
 * Interpreting fully connected layers of classification nets as 1x1 convolutions

 object segmentation, íŠ¹íˆ semantic segmentationì´ë‚˜ instance segmentationì˜ networkì— ëŒ€í•´ ë‚˜íƒ€ë‚˜ ìˆë‹¤.
 ì²« ë²ˆì§¸ë¡œ deep learning ê¸°ë²•ì„ ì‚¬ìš©í–ˆë˜ Fully-Covolutional Network (FCN)ê³¼ semantic segmentationì„ ìœ„í•œ ì²« ë²ˆì§¸ end-to-end networkì´ë‹¤.

 ![image](https://user-images.githubusercontent.com/122149118/222064921-13a4a1b3-aa7e-4959-99ea-981ce9e4740e.png)

 ê¸°ì¡´ì˜ image classificationì´ Query imageì— ëŒ€í•´ì„œ convolutionì„ í†µê³¼í•´ì„œ fully connected layerë¡œ í•˜ë‚˜ì˜ output vector, 1 by 1 by 21ê°œì˜ classë¥¼ ì˜ˆì¸¡í•˜ëŠ” output vectorë¥¼ ë§Œë“¤ì—ˆë‹¤ë©´ Semantic Segmentationì€ ë™ì¼í•˜ê²Œ Query imageê°€ ë“¤ì–´ê°€ convolutionì„ í†µê³¼í•´ì„œ output vectorê°€ ì•„ë‹ˆë¼ output feature mapì´ ë‚˜ì˜¨ë‹¤.
 ìœ„ì—ì„œëŠ” 16 by 16 by 21 sizeì˜ feature mapì´ ë„ì¶œë˜ì—ˆë‹¤.
 ê° ìœ„ì¹˜ì— ëŒ€í•´ì„œ ì–´ë–¤ resolutionì´ maxpoolingëœ, specially poolingëœ ì‘ì€ feature mapì´ ë‚˜ì˜¤ëŠ” í˜•íƒœë¡œ predictioní•œë‹¤.
 ì´ê²ƒì„ ë‹¤ì‹œ upsamplingí•˜ê²Œ ë˜ë©´ ê° query imageì— ëŒ€í•´ì„œ ì–´ë””ê°€ segmentaion maskì¸ì§€ ì•Œ ìˆ˜ ìˆê²Œëœë‹¤.
 ê° class labelì„ prediction í•  ìˆ˜ ìˆë‹¤.
 classification networkì˜ fully-connected layerë¥¼ 1 by 1 convolutionìœ¼ë¡œ í•´ì„í•˜ì—¬, fully-connected layerê°€ ê²°êµ­ ì–´ë–¤ FC layerê°€ 1 by 1 convolutionì´ ì˜ì—­ì— ëŒ€í•´ì„œsliding í•˜ëŠ” ê²ƒê³¼ ê°™ê¸° ë•Œë¬¸ì´ë‹¤.
 1 by 1 convolutionì„ ì‚¬ìš©í•˜ì—¬ convolutional networkë¥¼ ë¬˜ì‚¬í•˜ê²Œ ë˜ì—ˆë‹¤.

# Segmenter using Vision Transformer

 * Current model using vision transformer
 * Improving the segmentation quality very much

 ![image](https://user-images.githubusercontent.com/122149118/222066367-7603d0be-9835-44f2-b46b-85eb2fefa7fe.png)

 ìµœê·¼ ë‚˜ì˜¨ workëŠ” segmenterë¼ëŠ” ë°©ì‹ì¸ë° vision transformer êµ¬ì¡°ë¥¼ í™œìš©í•˜ì—¬ semantic segmentation ë¬¸ì œë¥¼ í‘¸ëŠ” ê²ƒì´ë‹¤. 
 21ë…„ì— ë‚˜ì˜¨ modelë¡œ segmentation qualityë¥¼ í¬ê²Œ ëŠ˜ë ¸ë‹¤.
 ë°©ì‹ì€ ì–´ë–¤ input imageê°€ ìˆìœ¼ë©´ patch ë‹¨ìœ„ë¡œ ìª¼ê°œì–´ Transformer encoder í†µê³¼ì‹œí‚¨ë‹¤.
 ë‹¤ì‹œ Mask Trasnsformerì— í†µê³¼ì‹œì¼œì„œ ì–´ë–¤ labelì— ëŒ€í•´ì„œ class tokenë“¤ì„ ë„£ì–´ì£¼ê³  ê·¸ classì— ëŒ€í•´ì„œ maskë¥¼ predictioní•œë‹¤. 
 pixel level classificationì´ë¯€ë¡œ ì–´ë–¤ mask scoreê°€ ê°€ì¥ ë†’ì€ patchì˜ levelì— ëŒ€í•´ì„œ ë‹¤ì‹œ upsamplingí•˜ê³  ë‹¤ì‹œ patchë¡œ í´ë”©í•´ì£¼ì–´ segmentation maskë¥¼ êµ¬í•´ë‚¸ë‹¤.
 pixel level scoreë¥¼ ì‚¬ìš©í•˜ì—¬ ì™„ì„±ëœ segmentation mapì„ ë„ì¶œí•œë‹¤.

# FCN (2015) to Segmenter (2021) for semantic segmentation

 ![image](https://user-images.githubusercontent.com/122149118/222522071-d4896b02-a9a8-4980-b5cb-da69e0d31e5d.png)

 â¬‡{: .center}

 ![image](https://user-images.githubusercontent.com/122149118/222523252-bbe86ba0-0f3d-4aa6-beb5-c488a3662688.png)

 ê²°ê³¼ì ìœ¼ë¡œ FCNê³¼ segmentation ì‚¬ì´ì— gapì´ ì¡´ì¬í•˜ëŠ”ë°, ë§¨ ìœ„ëŠ” FCNì˜ ê²°ê³¼ì´ë‹¤.
 ê¸°ì¡´ì˜ SDS, ê³ ì „ì ì¸ ë°©ë²•, Deep Learningì„ ì‚¬ìš©í•˜ì§€ ì•ŠëŠ” SDSì˜ ê²°ê³¼ê°€ ìœ„ì™€ ê°™ì´ ë„ì¶œë˜ëŠ”ë° FCNì€ ê³ ì „ì ì¸ ë°©ë²•ì— ë¹„í•´ì„œ ìƒë‹¹íˆ ì˜ì—­ë“¤ì„ ì˜ ì¡ì•„ë‚´ëŠ” ê²ƒì„ ë³¼ ìˆ˜ ìˆë‹¤.
 imageë¥¼ ë„£ì—ˆì„ ë•Œ Ground Truthì™€ ì–´ëŠì •ë„ ë§ê³¼ ì‚¬ëŒì˜ imageë„ ì¡ì•„ë‚´ê³  ì˜¤í† ë°”ì´ imageë“¤ë„ ë‚˜ë¦„ ì•½ê°„ì˜ noiseëŠ” ì¡´ì¬í•˜ì§€ë§Œ ì˜ ì¡ì•„ë‚´ëŠ” ê²°ê³¼ë¥¼ í™•ì¸í•  ìˆ˜ ìˆë‹¤.
 ì–‘ì— ëŒ€í•´ì„œë„ ì˜ ì¡ëŠ” ê²ƒì„ ë³¼ ìˆ˜ ìˆë‹¤.
 í•˜ì§€ë§Œ segmenterê¹Œì§€ ë„˜ì–´ì˜¤ëŠ” ê³¼ì •ì„ ë³´ë©´, Deep Learning ê¸°ë°˜ì˜ model ì¤‘ DeepLabv3+ê°€ ì¢‹ì€ modelì´ì—ˆì§€ë§Œ DeepLabv3+ì™€ ë¹„êµí–ˆì„ ë•Œ segmenterëŠ” boundaryê¹Œì§€ë„ ì•„ì£¼ ì˜ ì¡ì•„ì£¼ëŠ” ê²ƒì„ ë³¼ ìˆ˜ ìˆë‹¤.
 ê³µë“¤ì— ëŒ€í•´ì„œë„ í•˜ë‚˜í•˜ë‚˜ detailí•˜ê²Œ ê²°ê³¼ë¥¼ ì¡ì•„ë‚¸ë‹¤.
 ì´ëŸ¬í•œ ê²°ê³¼ë¥¼ DeepLabv3+ì™€ ë¹„êµí–ˆì„ ë•Œ í›¨ì”¬ ë” ì„¸ë¶€ì ìœ¼ë¡œ ì˜ ì¡ì•„ë‚´ëŠ” ê²°ê³¼ë¥¼ ë³´ì¸ë‹¤.
 ë§ˆì°¬ê°€ì§€ë¡œ DeepLabv3+ëŠ” ì‚¬ëŒë“¤ì— ëŒ€í•´ì„œë„ ì•½ê°„ í‹€ë¦´ ìˆ˜ë„ ìˆëŠ” ëª¨ìŠµì„ ë³´ì´ì§€ë§Œ segmenterëŠ” ì¡°ê¸ˆ ë” detailí•˜ê³  ì •í™•í•˜ê²Œ ì¡ì•„ë‚¸ë‹¤.
 DeepLabv3+ê°™ì€ ê²½ìš° noiseê°™ì€ ê²ƒë„ ìƒê¸°ì§€ë§Œ segmenterëŠ” ë” ì •í™•í•˜ê²Œ ì¡ì•„ë‚´ëŠ” ë” ì˜ í•™ìŠµë˜ëŠ” ëª¨ìŠµì„ ë³¼ ìˆ˜ ìˆë‹¤.